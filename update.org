* queries
  note t
** add field `allow_comments` to `article_content`
   ALTER TABLE  `article_content` ADD  `allowComments` TINYINT( 1 ) NOT NULL;
** + `article_comments`
   CREATE TABLE IF NOT EXISTS `article_comments` (
     `comment_id` int(11) NOT NULL AUTO_INCREMENT,
     `page_modulecomponentid` int(11) NOT NULL,
     `user` varchar(200) NOT NULL,
     `timestamp` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
     `comment` text NOT NULL,
     PRIMARY KEY (`comment_id`)
   ) ENGINE=MyISAM  DEFAULT CHARSET=latin1 ;

** + `article_draft`
   CREATE TABLE IF NOT EXISTS `article_draft` (
     `page_modulecomponentid` int(11) NOT NULL,
     `draft_number` int(11) NOT NULL,
     `draft_content` text NOT NULL,
     `draft_lastsaved` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' ON UPDATE CURRENT_TIMESTAMP,
     `user_id` int(11) NOT NULL
   ) ENGINE=MyISAM DEFAULT CHARSET=latin1;

** + `book_desc`
   CREATE TABLE IF NOT EXISTS `book_desc` (
     `page_modulecomponentid` int(11) NOT NULL,
     `initial` int(11) NOT NULL,
     `list` varchar(256) NOT NULL,
     `menu_hide` varchar(500) NOT NULL,
     PRIMARY KEY (`page_modulecomponentid`)
   ) ENGINE=MyISAM DEFAULT CHARSET=latin1;

** > `form_desc`
   ALTER TABLE  `form_desc` CHANGE  `form_heading`  `form_heading` VARCHAR( 1000 ) CHARACTER SET latin1 COLLATE latin1_swedish_ci NOT NULL;
** > `form_elementdesc`
   ALTER TABLE  `form_elementdesc` CHANGE  `form_elementname`  `form_elementname` VARCHAR( 1000 ) CHARACTER SET latin1 COLLATE latin1_swedish_ci NOT NULL ,
   CHANGE  `form_elementdisplaytext`  `form_elementdisplaytext` VARCHAR( 5000 ) CHARACTER SET latin1 COLLATE latin1_swedish_ci NOT NULL COMMENT  'Description of data held',
   CHANGE  `form_elementdefaultvalue`  `form_elementdefaultvalue` VARCHAR( 4000 ) CHARACTER SET latin1 COLLATE latin1_swedish_ci NULL DEFAULT NULL ,
   CHANGE  `form_elementmorethan`  `form_elementmorethan` VARCHAR( 4000 ) CHARACTER SET latin1 COLLATE latin1_swedish_ci NULL DEFAULT NULL ,
   CHANGE  `form_elementlessthan`  `form_elementlessthan` VARCHAR( 4000 ) CHARACTER SET latin1 COLLATE latin1_swedish_ci NULL DEFAULT NULL;

** + `forum_like`
   CREATE TABLE IF NOT EXISTS `forum_like` (
     `page_modulecomponentid` int(11) NOT NULL,
     `forum_thread_id` int(11) NOT NULL,
     `forum_post_id` int(11) NOT NULL,
     `forum_like_user_id` int(11) NOT NULL,
     `like_status` enum('0','1') NOT NULL COMMENT '(0-Dislike 1-like)'
   ) ENGINE=InnoDB DEFAULT CHARSET=latin1;

** > `forum_module`
   ALTER TABLE  `forum_module` CHANGE  `last_post_datetime`  `last_post_datetime` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
   ADD  `total_thread_count` INT( 11 ) NOT NULL DEFAULT  '1',
   ADD  `allow_delete_posts` ENUM(  '0',  '1' ) NOT NULL DEFAULT  '0' COMMENT  '(1-Allow 0-Don''t Allow)',
   ADD  `allow_like_posts` ENUM(  '0',  '1' ) NOT NULL DEFAULT  '0' COMMENT  '(1-Allow 0-Don''t Allow)';
** + `forum_visits`
   CREATE TABLE IF NOT EXISTS `forum_visits` (
     `page_modulecomponentid` int(11) NOT NULL,
     `user_id` int(11) NOT NULL,
     `last_visit` datetime NOT NULL
   ) ENGINE=MyISAM DEFAULT CHARSET=latin1;

** > `gallery_name`
   ALTER TABLE  `gallery_name` ADD  `imagesPerPage` INT( 11 ) NOT NULL DEFAULT  '6',
   ADD  `allowViews` TINYINT( 1 ) NOT NULL DEFAULT  '0';
** > `gallery_pics`
   ALTER TABLE  `gallery_pics` ADD  `pic_rate` INT( 11 ) NOT NULL;
** > `hospi_accomodation_status`
   ALTER TABLE `hospi_accomodation_status`
   DROP `hospi_projected_checkin`,
   DROP `hospi_projected_checkout`;

** > `hospi_hostel`
   ALTER TABLE  `hospi_hostel` ADD  `hospi_floor` INT( 1 ) NOT NULL
** > `news_desc`
   ALTER TABLE  `news_desc` CHANGE  `news_title`  `news_title` VARCHAR( 150 ) CHARACTER SET latin1 COLLATE latin1_swedish_ci NULL DEFAULT NULL ,
   CHANGE  `news_description`  `news_description` VARCHAR( 1000 ) CHARACTER SET latin1 COLLATE latin1_swedish_ci NULL DEFAULT NULL,
   ADD  `news_link` VARCHAR( 250 ) NULL DEFAULT NULL ,
   ADD  `news_copyright` VARCHAR( 1000 ) NULL DEFAULT NULL;
** - `poll_answers`
   DROP TABLE  `poll_answers`;
** + `list_images`
   CREATE TABLE IF NOT EXISTS `list_images` (
     `page_id` int(11) NOT NULL,
     `page_name` varchar(51) NOT NULL,
     `page_image` varchar(51) NOT NULL
   ) ENGINE=MyISAM DEFAULT CHARSET=latin1;
** + `list_prop`
CREATE TABLE IF NOT EXISTS `list_prop` (
 `page_modulecomponentid` int(11) NOT NULL,
 `depth` int(11) NOT NULL,
 UNIQUE KEY `page_modulecomponentid_2` (`page_modulecomponentid`),
 KEY `page_modulecomponentid` (`page_modulecomponentid`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;

** + `poll_content`
   CREATE TABLE IF NOT EXISTS `poll_content` (
     `pid` int(11) NOT NULL auto_increment,
     `page_modulecomponentid` int(11) NOT NULL,
     `ques` longtext NOT NULL,
     `o1` longtext NOT NULL,
     `o2` longtext NOT NULL,
     `o3` longtext NOT NULL,
     `o4` longtext NOT NULL,
     `o5` longtext NOT NULL,
     `o6` longtext NOT NULL,
     `multiple_opt` tinyint(1) NOT NULL default '0' COMMENT '1 indicates multiple options',
     `visibility` tinyint(1) NOT NULL default '1',
     PRIMARY KEY (`pid`)
   ) ENGINE=InnoDB DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;
** - `poll_questions`
   DROP TABLE  `poll_questions`;
** + `poll_log`
   CREATE TABLE IF NOT EXISTS `poll_log` (
     `pid` int(11) NOT NULL auto_increment,
     `page_modulecomponentid` int(11) NOT NULL,
     `o1` int(11) NOT NULL default '0',
     `o2` int(11) NOT NULL default '0',
     `o3` int(11) NOT NULL default '0',
     `o4` int(11) NOT NULL default '0',
     `o5` int(11) NOT NULL default '0',
     `o6` int(11) NOT NULL default '0',
     PRIMARY KEY (`pid`)
   ) ENGINE=InnoDB DEFAULT CHARSET=latin1 AUTO_INCREMENT=26 ;

** + `poll_users`
   CREATE TABLE IF NOT EXISTS `poll_users` (
     `pid` int(11) NOT NULL,
     `userID` int(11) NOT NULL,
     `page_modulecomponentid` int(11) NOT NULL
   ) ENGINE=InnoDB DEFAULT CHARSET=latin1;

** DONE + `prefix_modules`
   CREATE TABLE IF NOT EXISTS `pragyanV2_modules` (
     `module_name` varchar(128) NOT NULL,
     `module_tables` varchar(500) NOT NULL,
     `allow_uploads` tinyint(1),
     PRIMARY KEY (`module_name`)
   ) ENGINE=MyISAM DEFAULT CHARSET=latin1;

** DONE + `prefix_global`
   CREATE TABLE IF NOT EXISTS `pragyanV2_global` (
     `attribute` varchar(50) NOT NULL,
     `value` text NOT NULL,
     PRIMARY KEY (`attribute`)
   ) ENGINE=MyISAM DEFAULT CHARSET=latin1;

** DONE > `prefix_pages`
   ALTER TABLE  `pragyanV2_pages` CHANGE  `page_module`  `page_module` VARCHAR( 128 ) NOT NULL COMMENT  'Module type of the page',
   ADD `page_template` varchar(50) NOT NULL,
   ADD `page_image` varchar(300) DEFAULT NULL,
   ADD `page_displayinsitemap` tinyint(1) NOT NULL DEFAULT '1' COMMENT 'To display in sitemap or not',
   ADD `page_displayicon` tinyint(1) NOT NULL DEFAULT '1' COMMENT '1 - To display icon in menu 0 - Not to display icon in menu',
   ADD `page_menutype` enum('classic','complete','multidepth') NOT NULL DEFAULT 'classic' COMMENT 'Type of the menu : Classic (normal) or Drop-down (with some depth)',
   ADD `page_menudepth` int(11) NOT NULL DEFAULT '1',
   ADD `page_openinnewtab` tinyint(1) NOT NULL DEFAULT '0' COMMENT 'Whether to open the page in a new tab when clicked',
   ADD INDEX (  `page_module` ),
   AUTO_INCREMENT =5;

** TODO > `prefix_permissionlist`
   ALTER TABLE  `pragyanV2_permissionlist` CHANGE  `page_module`  `page_module` VARCHAR( 128 ) NOT NULL
//   , AUTO_INCREMENT =1
*** had some problem while executing this statement in phpmyadmin... had to empty the table to execute the query

** DONE + `prefix_templates`
   CREATE TABLE IF NOT EXISTS `pragyanV2_templates` (
     `template_name` varchar(50) NOT NULL,
     PRIMARY KEY (`template_name`)
   ) ENGINE=MyISAM DEFAULT CHARSET=latin1;

** DONE + `prefix_tempuploads`
   CREATE TABLE IF NOT EXISTS `pragyanV2_tempuploads` (
     `id` int(11) NOT NULL AUTO_INCREMENT,
     `filePath` varchar(500) NOT NULL,
     `info` varchar(1000) NOT NULL,
     PRIMARY KEY (`id`)
   ) ENGINE=MyISAM DEFAULT CHARSET=latin1 AUTO_INCREMENT=11 ;

** DONE > `prefix_uploads`
   ALTER TABLE  `pragyanV2_uploads`
   CHANGE  `page_module`  `page_module` VARCHAR( 128 ) NOT NULL,
   ADD FOREIGN KEY (`page_module`) REFERENCES `pragyanV2_modules`(`module_name`);

** DONE > `prefix_usergroup`
   ALTER TABLE  `pcmsv2`.`pragyanV2_usergroup` DROP INDEX  `user_id` ,
   ADD INDEX  `user_id` (  `user_id` , `group_id` );
   
** TODO what to do with `pragyanV2_userprofile_elementdata` and `pragyanV2_userprofile_elementdesc`??? how does the user details get transformed to some other tables???
** DONE `prefix_users`
   ALTER TABLE  `pragyanV2_users` CHANGE  `user_loginmethod`  `user_loginmethod` ENUM(  'openid',  'db',  'ldap',  'imap',  'ads' ) CHARACTER SET latin1 COLLATE latin1_swedish_ci NOT NULL DEFAULT  'db' COMMENT 'Login Method'

** DONE + `prefix_openid_users`
   CREATE TABLE IF NOT EXISTS `pragyanV2_openid_users` (
     `openid_id` INT NOT NULL AUTO_INCREMENT,
     `openid_url` VARCHAR(2063) NOT NULL ,
     `user_id` INT NOT NULL ,
     PRIMARY KEY (`openid_id`)
   )ENGINE = MyISAM ;
   
** DONE + `prefix_widgets`
   CREATE TABLE IF NOT EXISTS `pragyanV2_widgets` (
     `widget_id` int(11) NOT NULL,
     `widget_instanceid` int(11) NOT NULL,
     `page_id` int(11) NOT NULL,
     `widget_location` int(11) NOT NULL,
     `widget_order` int(11) NOT NULL,
     `widget_propagate` int(1) NOT NULL DEFAULT '0',
     PRIMARY KEY (`widget_id`,`widget_instanceid`)
   ) ENGINE=MyISAM DEFAULT CHARSET=latin1;

** DONE + `prefix_widgetsconfig`
   CREATE TABLE IF NOT EXISTS `pragyanV2_widgetsconfig` (
     `widget_id` int(11) NOT NULL,
     `widget_instanceid` int(11) NOT NULL,
     `config_name` varchar(128) NOT NULL,
     `config_value` longtext NOT NULL,
     PRIMARY KEY (`widget_id`,`widget_instanceid`,`config_name`)
   ) ENGINE=MyISAM DEFAULT CHARSET=latin1;

** DONE + `prefix_widgetsdata`
   CREATE TABLE IF NOT EXISTS `pragyanV2_widgetsdata` (
     `widget_id` int(11) NOT NULL,
     `widget_instanceid` int(11) NOT NULL,
     `widget_datakey` varchar(500) NOT NULL,
     `widget_datavalue` longtext NOT NULL,
     PRIMARY KEY (`widget_id`,`widget_instanceid`,`widget_datakey`)
   ) ENGINE=MyISAM DEFAULT CHARSET=latin1;
** DONE + `prefix_widgetsconfiginfo`
   CREATE TABLE IF NOT EXISTS `pragyanV2_widgetsconfiginfo` (
     `widget_id` int(11) NOT NULL,
     `config_name` varchar(128) NOT NULL,
     `config_type` enum('text','textarea','bool','integer','date','select','hidden','datetime','file','radio','checkbox','noinput') NOT NULL,
     `config_options` text NOT NULL,
     `config_displaytext` text NOT NULL,
     `config_default` longtext NOT NULL,
     `is_global` int(1) NOT NULL,
     `config_rank` int(10) NOT NULL,
     PRIMARY KEY (`widget_id`,`config_name`)
   ) ENGINE=MyISAM DEFAULT CHARSET=latin1;
** DONE + `prefix_widgetsinfo`
   CREATE TABLE IF NOT EXISTS `pragyanV2_widgetsinfo` (
     `widget_id` INT( 11 ) NOT NULL AUTO_INCREMENT PRIMARY KEY ,
     `widget_name` VARCHAR( 100 ) NOT NULL ,
     `widget_classname` VARCHAR ( 100 ) NOT NULL,
     `widget_description` MEDIUMTEXT NOT NULL ,
     `widget_version` VARCHAR( 27 ) NOT NULL ,
     `widget_author` TEXT NULL ,
     `widget_foldername` VARCHAR( 27 ) NOT NULL ,
     UNIQUE ( `widget_foldername` )
   ) ENGINE=MYISAM DEFAULT CHARSET=latin1;

** TODO the entire quiz module has possibly been rewritten... skipping this part... ask chakra about how the database structure has been transformed.... just hoping that nitt website doesn't have any page of type quiz
** + `safedit_sections`
   CREATE TABLE IF NOT EXISTS `safedit_sections` (
     `page_modulecomponentid` int(11) NOT NULL,
     `section_id` int(11) NOT NULL,
     `section_heading` varchar(256) DEFAULT NULL,
     `section_type` varchar(64) DEFAULT NULL,
     `section_show` tinyint(4) NOT NULL,
     `section_priority` int(11) DEFAULT NULL,
     `section_content` text
   ) ENGINE=MyISAM DEFAULT CHARSET=latin1;


** + `share`
   CREATE TABLE IF NOT EXISTS `share` (
     `page_modulecomponentid` int(11) NOT NULL,
     `page_desc` text NOT NULL,
     `file_type` varchar(100) NOT NULL,
     `maxfile_size` int(11) NOT NULL,
     PRIMARY KEY (`page_modulecomponentid`)
   ) ENGINE=MyISAM DEFAULT CHARSET=latin1;

** + `share_comments`
   CREATE TABLE IF NOT EXISTS `share_comments` (
     `comment_id` int(11) NOT NULL,
     `file_id` int(11) NOT NULL,
     `page_modulecomponentid` int(11) NOT NULL,
     `comment` text NOT NULL,
     `userid` int(11) NOT NULL,
     `comment_datetime` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
     PRIMARY KEY (`comment_id`)
   ) ENGINE=MyISAM DEFAULT CHARSET=latin1;

** + `share_files`
   CREATE TABLE IF NOT EXISTS `share_files` (
     `file_id` int(11) NOT NULL AUTO_INCREMENT,
     `page_modulecomponentid` int(11) NOT NULL,
     `upload_filename` varchar(50) NOT NULL,
     `file_name` varchar(50) NOT NULL,
     `file_desc` text NOT NULL,
     `upload_userid` int(11) NOT NULL,
     PRIMARY KEY (`file_id`)
   ) ENGINE=MyISAM DEFAULT CHARSET=latin1 AUTO_INCREMENT=8 ;

** queries for sphider search
create table sites(
	site_id int auto_increment not null primary key,
	url varchar(255),
	title varchar(255),
	short_desc text,
	indexdate date,
	spider_depth int default 2,
	required text,
	disallowed text,
	can_leave_domain bool) ENGINE = MYISAM;
create table links (
	link_id int auto_increment primary key not null,
	site_id int,
	url varchar(255) not null,
	title varchar(200),
	description varchar(255),
	fulltxt mediumtext,
	indexdate date,
	size float(2),
	md5sum varchar(32),
	key url (url),
	key md5key (md5sum),
	visible int default 0, 
	level int) ENGINE = MYISAM;
create table keywords	(
	keyword_id int primary key not null auto_increment,
	keyword varchar(30) not null,
	unique kw (keyword),
	key keyword (keyword(10))) ENGINE = MYISAM;
create table link_keyword0 (
	link_id int not null,
	keyword_id int not null,
	weight int(3),
	domain int(4),
	key linkid(link_id),
	key keyid(keyword_id)) ENGINE = MYISAM;
create table link_keyword1 (
	link_id int not null,
	keyword_id int not null,
	weight int(3),
	domain int(4),
	key linkid(link_id),
	key keyid(keyword_id)) ENGINE = MYISAM;
create table link_keyword2 (
	link_id int not null,
	keyword_id int not null,
	weight int(3),
	domain int(4),
	key linkid(link_id),
	key keyid(keyword_id)) ENGINE = MYISAM;
create table link_keyword3 (
	link_id int not null,
	keyword_id int not null,
	weight int(3),
	domain int(4),
	key linkid(link_id),
	key keyid(keyword_id)) ENGINE = MYISAM;
create table link_keyword4 (
	link_id int not null,
	keyword_id int not null,
	weight int(3),
	domain int(4),
	key linkid(link_id),
	key keyid(keyword_id)) ENGINE = MYISAM;
create table link_keyword5 (
	link_id int not null,
	keyword_id int not null,
	weight int(3),
	domain int(4),
	key linkid(link_id),
	key keyid(keyword_id)) ENGINE = MYISAM;
create table link_keyword6 (
	link_id int not null,
	keyword_id int not null,
	weight int(3),
	domain int(4),
	key linkid(link_id),
	key keyid(keyword_id)) ENGINE = MYISAM;
create table link_keyword7 (
	link_id int not null,
	keyword_id int not null,
	weight int(3),
	domain int(4),
	key linkid(link_id),
	key keyid(keyword_id)) ENGINE = MYISAM;
create table link_keyword8 (
	link_id int not null,
	keyword_id int not null,
	weight int(3),
	domain int(4),
	key linkid(link_id),
	key keyid(keyword_id)) ENGINE = MYISAM;
create table link_keyword9 (
	link_id int not null,
	keyword_id int not null,
	weight int(3),
	domain int(4),
	key linkid(link_id),
	key keyid(keyword_id)) ENGINE = MYISAM;
create table link_keyworda (
	link_id int not null,
	keyword_id int not null,
	weight int(3),
	domain int(4),
	key linkid(link_id),
	key keyid(keyword_id)) ENGINE = MYISAM;
create table link_keywordb (
	link_id int not null,
	keyword_id int not null,
	weight int(3),
	domain int(4),
	key linkid(link_id),
	key keyid(keyword_id)) ENGINE = MYISAM;
create table link_keywordc (
	link_id int not null,
	keyword_id int not null,
	weight int(3),
	domain int(4),
	key linkid(link_id),
	key keyid(keyword_id)) ENGINE = MYISAM;
create table link_keywordd (
	link_id int not null,
	keyword_id int not null,
	weight int(3),
	domain int(4),
	key linkid(link_id),
	key keyid(keyword_id)) ENGINE = MYISAM;
create table link_keyworde (
	link_id int not null,
	keyword_id int not null,
	weight int(3),
	domain int(4),
	key linkid(link_id),
	key keyid(keyword_id)) ENGINE = MYISAM;
create table link_keywordf (
	link_id int not null,
	keyword_id int not null,
	weight int(3),
	domain int(4),
	key linkid(link_id),
	key keyid(keyword_id)) ENGINE = MYISAM;
create table categories(
	category_id integer not null auto_increment primary key, 
	category text,
	parent_num integer
	) ENGINE = MYISAM;
create table site_category (
	site_id integer,
	category_id integer
	) ENGINE = MYISAM;
create table temp (
	link varchar(255),
	level integer,
	id varchar (32)
	) ENGINE = MYISAM;
create table pending (
	site_id integer,
	temp_id varchar(32),
	level integer,
	count integer,
	num integer) ENGINE = MYISAM;

create table query_log (
	query varchar(255),
	time timestamp(14),
	elapsed float(2),
	results int,
	key query_key(query)
	) ENGINE = MYISAM;

create table domains (
	domain_id int auto_increment primary key not null,	
	domain varchar(255)
) ENGINE = MYISAM;

** upgrade script for sphider in order
*** v1.2
create table query_log (
	query varchar(255),
	time timestamp(14),
	elapsed float(2),
	results int);

alter table links add column size float(2) after indexdate;

*** v1.2.5
alter table links add column description varchar(255) after title;
update sites set url =concat("http://", url);
update links set url =concat("http://", url);

*** v1.2.6
alter table sites add column spider_depth int default 2, add column required text, add column disallowed text, add column can_leave_domain bool;
alter table links add column visible int default 0, add column level int;

*** v_new
alter table sites add column spider_depth int default 2, must_include text, mustnot_include text;
alter table links add column visible int default 1;
